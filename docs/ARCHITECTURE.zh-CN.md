# Fireseed Capsule 架构说明（中文概要）

> ⚠ 提示：本篇是中文概要版，方便理解整体思路。  
> 详细、权威、保持最新的版本请以英文版为准：  
> 👉 [ARCHITECTURE.md](ARCHITECTURE.md)

## 1. 这套架构想解决什么问题？

一句话版本：

> 用一套 **可验证、可签名、可复现** 的结构，让“一个人的人生说明书”能被未来的机器直接读取，而不是靠猜。

所以，这个仓库主要在解决三件事：

1. 用 **Schema** 把“人生经历 + 价值观 + 证据”变成结构化数据（capsule）。
2. 用 **确定性编码 + 签名** 把 capsule 变成可验证的 CID + 签名。
3. 用 **CLI + Web 前端** 让这些操作对人类用户是可用的。

---

## 2. 目录和模块是怎么分工的？

- `schemas/`：定义 capsule 长什么样、哪些字段必须有、哪些值被禁止。
- `scripts/`：在命令行里完成“编码 → 计算 CID → 签名 → 打包 CAR”等操作。
- `app/`：Next.js Web 应用，负责和人打交道（编辑、预览、Demo 等）。
- `public/`：一些早期的静态工具页面（generator/validator），可以离线使用。
- `docs/`：架构文档、威胁模型、架构决策记录。
- `.github/workflows/`：CI 配置，自动化测试、合规扫描、构建发布。

可以把它想成：

> `schemas` + `scripts` = 核心引擎  
> `app` + `public` = 人类界面  
> `docs` + `.github` = 解释和约束

---

## 3. 从“草稿”到“签名 Capsule”的流程

1. 用户写一个 capsule 草稿（YAML 或 JSON）。
2. 用 `schemas/capsule_v0.json` 校验结构是否合规。
3. 用 DAG-CBOR 做确定性编码，得到字节序列。
4. 对编码结果计算哈希，得到 CID。
5. 使用 Ed25519 私钥对 CID 签名，形成“这真的是我说的话”的证明。
6. 如果需要，可以把 capsule + 相关内容打包进 CAR，上传到 IPFS 再做 Pin。

其中 **3–5 步** 可以通过：

- 命令行脚本完成（适合熟悉终端的用户）；
- 或在浏览器里用 WebAuthn / SubtleCrypto 完成（适合普通用户 Demo）。

---

## 4. Web 前端在这里扮演什么角色？

前端（`app/` + `public/`）的职责主要是：

- 帮助用户用尽量自然的方式填完一份复杂的结构化文档；
- 在本地做基础校验，避免生成“明显不合规”的 capsule；
- 把复杂的“编码 / 签名 / CID”流程变成按钮和提示。

安全边界上：

- 浏览器端尽量使用 **WebAuthn / Passkey**，让私钥呆在安全硬件里；
- 前端只展示“你签了什么”，不窥探你的私钥内容。

---

## 5. 这份中文文档的作用

- 主要是给中文读者一个“全局鸟瞰图”和人话总结；
- 真正细节（字段定义、具体函数、CI 行为）请始终以英文版为主：  
  👉 [ARCHITECTURE.md](ARCHITECTURE.md)

后续如果英文版有重大升级，这个中文概要会适当跟进更新。
