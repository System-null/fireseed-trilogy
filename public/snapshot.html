
<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<title>Fireseed Capsule Snapshot</title>
<style>
  body { font-family: system-ui, sans-serif; max-width: 700px; margin: 40px auto; line-height: 1.6; color: #222; }
  h1 { text-align: center; }
  .section { margin: 1.5em 0; }
  .card { background: #f9f9f9; border-left: 4px solid #444; padding: 1em; border-radius: 8px; }
  .footer { font-size: 0.9em; color: #666; margin-top: 2em; border-top: 1px solid #ddd; padding-top: 1em; }
  button { margin-top: 1em; padding: 8px 16px; border-radius: 4px; cursor: pointer; background: #222; color: #fff; }
</style>
</head>
<body>
<h1>火种胶囊快照 / Fireseed Capsule Snapshot</h1>

<div id="snapshot" class="section">
  <div class="card">
    <p><strong>创建者：</strong><span id="owner">加载中...</span></p>
    <p><strong>语言：</strong><span id="locale"></span></p>
    <p><strong>时间：</strong><span id="timestamp"></span></p>
  </div>

  <div class="section">
    <h3>核心原则</h3>
    <ul id="principles"></ul>
  </div>

  <div class="section">
    <h3>不可妥协</h3>
    <ul id="non_negotiables"></ul>
  </div>

  <div class="section">
    <h3>叙事摘录</h3>
    <p id="story"></p>
  </div>

  <div class="section">
    <h3>留言 / Messages</h3>
    <ul id="messages"></ul>
  </div>
</div>

<div class="footer">
  <p>⚠️ 本页仅展示人类可读摘要。</p>
  <p><a id="downloadLink" href="#">下载完整 YAML</a></p>
</div>

<script>
const params = new URLSearchParams(window.location.search);
const hash = params.get('hash') || 'demo';

fetch(`https://ipfs.io/ipfs/${hash}`)
  .then(r => r.text())
  .then(t => {
    const capsule = jsyaml.load(t);
    document.getElementById("owner").innerText = capsule.owner || "匿名";
    document.getElementById("locale").innerText = capsule.locale || "zh-CN";
    document.getElementById("timestamp").innerText = capsule.meta?.generated_at || "未知时间";
    document.getElementById("principles").innerHTML = (capsule.principles || []).map(p => `<li>${p}</li>`).join('');
    document.getElementById("non_negotiables").innerHTML = (capsule.non_negotiables || []).map(p => `<li>${p}</li>`).join('');
    document.getElementById("story").innerText = capsule.narrative?.story || "(暂无)";
    document.getElementById("messages").innerHTML = (capsule.narrative?.messages || []).map(m => `<li>${m.to}: ${m.text}</li>`).join('');
    document.getElementById("downloadLink").href = `https://ipfs.io/ipfs/${hash}`;
  })
  .catch(() => {
    document.getElementById("story").innerText = "无法加载胶囊内容，请稍后重试。";
  });
</script>
<script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>
</body>
</html>
